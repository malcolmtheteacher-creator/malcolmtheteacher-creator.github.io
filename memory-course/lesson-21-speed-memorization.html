<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 21: Speed Memorization - Memory Course</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1a1a2e;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #16213e;
            border: 2px solid #d4af37;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }

        h1 {
            color: #d4af37;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        .subtitle {
            text-align: center;
            color: #a0a0a0;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #d4af37;
            padding-bottom: 10px;
        }

        .tab-button {
            background-color: #0f3460;
            color: #d4af37;
            border: 2px solid #d4af37;
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .tab-button:hover {
            background-color: #d4af37;
            color: #1a1a2e;
            transform: translateY(-2px);
        }

        .tab-button.active {
            background-color: #d4af37;
            color: #1a1a2e;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            color: #d4af37;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-left: 4px solid #d4af37;
            padding-left: 15px;
        }

        .content-block {
            background-color: #0f3460;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #d4af37;
            border-radius: 5px;
        }

        .drill-container {
            background-color: #0f3460;
            padding: 30px;
            border-radius: 5px;
            text-align: center;
            margin-bottom: 20px;
        }

        .items-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .item-card {
            background-color: #16213e;
            border: 2px solid #d4af37;
            padding: 15px;
            border-radius: 5px;
            font-size: 1.3em;
            font-weight: bold;
            color: #d4af37;
            text-align: center;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .timer {
            font-size: 2.5em;
            color: #d4af37;
            font-weight: bold;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .btn {
            background-color: #d4af37;
            color: #1a1a2e;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background-color: #e6c547;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: #16213e;
            color: #d4af37;
            border: 2px solid #d4af37;
        }

        .btn-secondary:hover {
            background-color: #0f3460;
        }

        .progress-bar {
            background-color: #0f3460;
            border: 2px solid #d4af37;
            height: 30px;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #d4af37, #e6c547);
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a2e;
            font-weight: bold;
            transition: width 0.3s ease;
        }

        .speed-level {
            display: inline-block;
            padding: 8px 15px;
            background-color: #d4af37;
            color: #1a1a2e;
            border-radius: 5px;
            font-weight: bold;
            margin: 5px;
            font-size: 0.9em;
        }

        .analytics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background-color: #0f3460;
            border: 2px solid #d4af37;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-label {
            color: #a0a0a0;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stat-value {
            color: #d4af37;
            font-size: 2em;
            font-weight: bold;
        }

        .challenge-box {
            background: linear-gradient(135deg, #16213e, #0f3460);
            border: 3px solid #d4af37;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }

        .challenge-title {
            color: #d4af37;
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .memory-input {
            width: 100%;
            padding: 12px;
            background-color: #16213e;
            border: 2px solid #d4af37;
            color: #d4af37;
            border-radius: 5px;
            font-size: 1em;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }

        .feedback {
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-weight: bold;
        }

        .feedback.success {
            background-color: rgba(100, 200, 100, 0.3);
            border: 2px solid #64c864;
            color: #64c864;
        }

        .feedback.error {
            background-color: rgba(200, 100, 100, 0.3);
            border: 2px solid #c86464;
            color: #c86464;
        }

        .strategy-list {
            list-style: none;
            margin: 15px 0;
        }

        .strategy-list li {
            padding: 10px;
            margin: 8px 0;
            background-color: #0f3460;
            border-left: 4px solid #d4af37;
            border-radius: 3px;
        }

        .strategy-list li::before {
            content: "‚Üí ";
            color: #d4af37;
            font-weight: bold;
            margin-right: 10px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Speed Memorization</h1>
        <p class="subtitle">Lesson 21: Rapid Encoding Strategies for Competition</p>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab(0)">1. Retrieval</button>
            <button class="tab-button" onclick="switchTab(1)">2. New Content</button>
            <button class="tab-button" onclick="switchTab(2)">3. Guided Practice</button>
            <button class="tab-button" onclick="switchTab(3)">4. Elaboration</button>
            <button class="tab-button" onclick="switchTab(4)">5. Independent</button>
            <button class="tab-button" onclick="switchTab(5)">6. Final Retrieval</button>
        </div>

        <!-- TAB 1: RETRIEVAL -->
        <div class="tab-content active">
            <h2 class="section-title">Retrieval: What Do You Remember?</h2>
            <div class="content-block">
                <p>Before learning speed techniques, let's test your baseline. Below are 10 random items. Give yourself 60 seconds to memorize them using your current method.</p>
            </div>

            <div class="drill-container">
                <h3 style="color: #d4af37; margin-bottom: 20px;">Quick Recall Test</h3>
                <p style="margin-bottom: 15px;">Time remaining:</p>
                <div class="timer" id="baselineTimer">60</div>
                <div class="items-display" id="baselineItems"></div>
                <div class="button-group">
                    <button class="btn" onclick="startBaseline()">Start Memorization</button>
                    <button class="btn btn-secondary" onclick="hideBaseline()">Done - Check Answers</button>
                </div>
            </div>

            <div class="challenge-box hidden" id="baselineFeedback">
                <div class="challenge-title">Your Baseline</div>
                <div id="baselineResult"></div>
            </div>
        </div>

        <!-- TAB 2: NEW CONTENT -->
        <div class="tab-content">
            <h2 class="section-title">Rapid Encoding Strategies</h2>

            <div class="content-block">
                <h3 style="color: #d4af37; margin-bottom: 15px;">Pre-made Image Libraries</h3>
                <p>Champions don't create images on the fly. They use pre-made, tested images for common items:</p>
                <ul class="strategy-list">
                    <li><strong>1-100:</strong> Major System (pre-loaded)</li>
                    <li><strong>Common Objects:</strong> Apple, Car, Elephant, House (always consistent)</li>
                    <li><strong>Speed Benefit:</strong> 0.5 seconds per item vs. 2-3 seconds for novices</li>
                </ul>
            </div>

            <div class="content-block">
                <h3 style="color: #d4af37; margin-bottom: 15px;">Automatic Associations</h3>
                <p>Practice linking until it becomes automatic. Examples:</p>
                <ul class="strategy-list">
                    <li><strong>Elephant:</strong> Always MASSIVE and LOUD in your palace</li>
                    <li><strong>Bicycle:</strong> Always MOVING FAST and SPINNING</li>
                    <li><strong>Anchor Image:</strong> Starts at same location every time</li>
                </ul>
            </div>

            <div class="content-block">
                <h3 style="color: #d4af37; margin-bottom: 15px;">Mental Chaining Speed Tips</h3>
                <ul class="strategy-list">
                    <li>Don't pause between images - flow continuously</li>
                    <li>Exaggerate first, ask questions later</li>
                    <li>Use your palace path on autopilot</li>
                    <li>Store multiple items per location (stacking)</li>
                </ul>
            </div>

            <div class="challenge-box">
                <div class="challenge-title">Key Insight: Speed vs. Accuracy</div>
                <p style="color: #e0e0e0; margin-top: 10px;">The paradox: Going faster actually improves accuracy because you use less "thinking" and more "automatic flow." When you hesitate, you create weak links. Confidence creates stronger memories.</p>
            </div>
        </div>

        <!-- TAB 3: GUIDED PRACTICE -->
        <div class="tab-content">
            <h2 class="section-title">Guided Speed Drill: 10 Items</h2>

            <div class="content-block">
                <p>I will show you 10 items with a 30-second countdown. The coach will guide you through the process. Don't overthink - follow the flow!</p>
            </div>

            <div class="drill-container">
                <h3 style="color: #d4af37; margin-bottom: 20px;">Memorization Phase</h3>
                <p id="coachGuidance" style="margin-bottom: 15px; color: #a0a0a0;"></p>
                <div class="timer" id="guidedTimer">30</div>
                <div class="items-display" id="guidedItems"></div>
                <div class="button-group">
                    <button class="btn" onclick="startGuided()">Start 30-Second Drill</button>
                    <button class="btn btn-secondary" onclick="stopGuided()">I'm Done</button>
                </div>
            </div>

            <div id="guidedFeedback" class="challenge-box hidden">
                <div class="challenge-title">Recall Your Items</div>
                <p style="color: #e0e0e0; margin-bottom: 15px;">Type the items in order (comma-separated):</p>
                <textarea id="guidedRecall" class="memory-input" rows="4" placeholder="item1, item2, item3..."></textarea>
                <button class="btn" onclick="checkGuidedRecall()">Check Answer</button>
                <div id="guidedRecallResult"></div>
            </div>
        </div>

        <!-- TAB 4: ELABORATION -->
        <div class="tab-content">
            <h2 class="section-title">Bottleneck Analysis: Where Do You Slow Down?</h2>

            <div class="content-block">
                <h3 style="color: #d4af37; margin-bottom: 15px;">Speed Breakdown</h3>
                <p>Champions analyze where they lose time. Rate each stage:</p>
                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 15px 0;">
                        <strong>Encoding (creating image):</strong> üê¢ Very slow ‚Üí ‚ö° Instant
                        <input type="range" min="1" max="5" value="3" style="width: 100%; margin-top: 10px;">
                    </label>
                    <label style="display: block; margin: 15px 0;">
                        <strong>Linking (connecting images):</strong> üê¢ Very slow ‚Üí ‚ö° Instant
                        <input type="range" min="1" max="5" value="3" style="width: 100%; margin-top: 10px;">
                    </label>
                    <label style="display: block; margin: 15px 0;">
                        <strong>Placing (location in palace):</strong> üê¢ Very slow ‚Üí ‚ö° Instant
                        <input type="range" min="1" max="5" value="3" style="width: 100%; margin-top: 10px;">
                    </label>
                </div>
            </div>

            <div class="content-block">
                <h3 style="color: #d4af37; margin-bottom: 15px;">Progressive Speed Challenge</h3>
                <p style="margin-bottom: 20px;">Ready to test yourself at different speeds? These get progressively harder:</p>
                <div class="button-group">
                    <button class="speed-level" onclick="speedChallenge(60)">60 sec</button>
                    <button class="speed-level" onclick="speedChallenge(45)">45 sec</button>
                    <button class="speed-level" onclick="speedChallenge(30)">30 sec</button>
                    <button class="speed-level" onclick="speedChallenge(15)">15 sec</button>
                </div>
                <div id="speedChallengeContainer" class="hidden">
                    <div class="timer" id="speedTimer">60</div>
                    <div class="items-display" id="speedItems"></div>
                    <div class="button-group">
                        <button class="btn" onclick="finishSpeedChallenge()">Finished</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 5: INDEPENDENT PRACTICE -->
        <div class="tab-content">
            <h2 class="section-title">Independent Practice: All Systems at Speed</h2>

            <div class="content-block">
                <p>You're in control now. Choose your challenge level and test yourself with random item lists at your chosen speed.</p>
            </div>

            <div class="drill-container">
                <h3 style="color: #d4af37; margin-bottom: 20px;">Custom Speed Drill</h3>
                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 15px 0;">
                        <strong>Number of items:</strong>
                        <input type="number" id="customItemCount" value="10" min="5" max="50" style="width: 60px; padding: 8px; background-color: #16213e; border: 2px solid #d4af37; color: #d4af37; border-radius: 3px;">
                    </label>
                    <label style="display: block; margin: 15px 0;">
                        <strong>Time limit (seconds):</strong>
                        <input type="number" id="customTime" value="30" min="5" max="300" style="width: 60px; padding: 8px; background-color: #16213e; border: 2px solid #d4af37; color: #d4af37; border-radius: 3px;">
                    </label>
                </div>
                <div class="button-group">
                    <button class="btn" onclick="startCustomChallenge()">Start Challenge</button>
                </div>
            </div>

            <div id="customChallengeContainer" class="hidden">
                <div class="drill-container">
                    <div class="timer" id="customTimer">30</div>
                    <div class="items-display" id="customItems"></div>
                    <button class="btn" onclick="finishCustomChallenge()" style="margin-top: 20px;">I'm Done</button>
                </div>
                <div class="challenge-box hidden" id="customRecallContainer">
                    <div class="challenge-title">Recall Challenge</div>
                    <p style="color: #e0e0e0; margin-bottom: 15px;">Type all items in order:</p>
                    <textarea id="customRecall" class="memory-input" rows="5" placeholder="item1, item2, item3..."></textarea>
                    <button class="btn" onclick="checkCustomRecall()">Check Answer</button>
                    <div id="customRecallResult"></div>
                </div>
            </div>
        </div>

        <!-- TAB 6: FINAL RETRIEVAL -->
        <div class="tab-content">
            <h2 class="section-title">Final Retrieval: Competition Simulation</h2>

            <div class="content-block">
                <p>This is it. One final challenge designed to mimic real competition conditions. You have 30 seconds to memorize 10 items, then you must recall them perfectly.</p>
            </div>

            <div class="drill-container">
                <div class="timer" id="finalTimer">30</div>
                <div class="items-display" id="finalItems"></div>
                <div class="button-group">
                    <button class="btn" onclick="startFinalChallenge()">Begin Final Challenge</button>
                </div>
            </div>

            <div id="finalRecallContainer" class="hidden">
                <div class="challenge-box">
                    <div class="challenge-title">Recall Phase</div>
                    <p style="color: #e0e0e0; margin-bottom: 15px;">Type all 10 items in exact order (comma-separated):</p>
                    <textarea id="finalRecall" class="memory-input" rows="4" placeholder="item1, item2, item3..."></textarea>
                    <button class="btn" onclick="submitFinalRecall()">Submit Answer</button>
                </div>
            </div>

            <div id="finalResults" class="hidden">
                <div class="analytics">
                    <div class="stat-box">
                        <div class="stat-label">Items Correct</div>
                        <div class="stat-value" id="finalCorrect">0/10</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Accuracy</div>
                        <div class="stat-value" id="finalAccuracy">0%</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Speed (per item)</div>
                        <div class="stat-value" id="finalSpeed">3.0s</div>
                    </div>
                </div>
                <div class="challenge-box">
                    <div class="challenge-title">Detailed Feedback</div>
                    <div id="finalFeedback" style="color: #e0e0e0;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ITEMS_LIST = [
            'Elephant', 'Bicycle', 'Sandwich', 'Lighthouse', 'Penguin',
            'Guitar', 'Volcano', 'Briefcase', 'Fireworks', 'Watermelon',
            'Anchor', 'Castle', 'Dinosaur', 'Feather', 'Globe',
            'Hammer', 'Iceberg', 'Jet', 'Keyboard', 'Lighthouse',
            'Microscope', 'Noodles', 'Octopus', 'Pyramid', 'Quilt',
            'Rainbow', 'Submarine', 'Telescope', 'Umbrella', 'Volcano',
            'Waterfall', 'X-ray', 'Yoyo', 'Zebra', 'Aisle',
            'Backpack', 'Candle', 'Diamond', 'Elephant', 'Feather'
        ];

        let currentTab = 0;
        let currentChallenge = {
            items: [],
            startTime: 0,
            timeLimit: 30
        };

        function getRandomItems(count) {
            let items = [];
            for (let i = 0; i < count; i++) {
                items.push(ITEMS_LIST[Math.floor(Math.random() * ITEMS_LIST.length)]);
            }
            return items;
        }

        function switchTab(tabIndex) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');

            tabs.forEach((tab, i) => {
                tab.classList.remove('active');
                buttons[i].classList.remove('active');
            });

            tabs[tabIndex].classList.add('active');
            buttons[tabIndex].classList.add('active');
            currentTab = tabIndex;
        }

        function displayItems(elementId, items) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            items.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.textContent = `${index + 1}. ${item}`;
                container.appendChild(card);
            });
        }

        function startTimer(elementId, seconds, callback) {
            let timeLeft = seconds;
            const display = document.getElementById(elementId);

            const interval = setInterval(() => {
                display.textContent = timeLeft;

                if (timeLeft <= 5) {
                    display.style.color = '#c86464';
                } else {
                    display.style.color = '#d4af37';
                }

                timeLeft--;

                if (timeLeft < 0) {
                    clearInterval(interval);
                    display.textContent = '0';
                    if (callback) callback();
                }
            }, 1000);

            return interval;
        }

        // BASELINE
        function startBaseline() {
            currentChallenge.items = getRandomItems(10);
            currentChallenge.startTime = Date.now();
            currentChallenge.timeLimit = 60;

            displayItems('baselineItems', currentChallenge.items);
            document.getElementById('baselineFeedback').classList.add('hidden');

            startTimer('baselineTimer', 60, () => {
                alert('Time\'s up! Do you want to recall now?');
            });
        }

        function hideBaseline() {
            const recall = prompt('Type items in order (comma-separated):');
            if (recall) {
                const userItems = recall.split(',').map(i => i.trim());
                const correct = userItems.filter((item, idx) => item === currentChallenge.items[idx]).length;

                const feedback = document.getElementById('baselineFeedback');
                feedback.classList.remove('hidden');
                feedback.innerHTML = `
                    <div class="challenge-title">Your Baseline Result</div>
                    <div class="stat-box">
                        <div class="stat-label">Correct Items</div>
                        <div class="stat-value">${correct}/10</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Accuracy</div>
                        <div class="stat-value">${(correct / 10 * 100).toFixed(0)}%</div>
                    </div>
                    <p style="margin-top: 15px; color: #e0e0e0;">Expected items: ${currentChallenge.items.join(', ')}</p>
                    <p style="margin-top: 10px; color: #d4af37;">Your recall: ${userItems.join(', ')}</p>
                `;
            }
        }

        // GUIDED
        function startGuided() {
            currentChallenge.items = getRandomItems(10);
            currentChallenge.startTime = Date.now();
            currentChallenge.timeLimit = 30;

            displayItems('guidedItems', currentChallenge.items);
            document.getElementById('guidedFeedback').classList.add('hidden');

            const guidance = [
                'Anchor your first item in your starting location...',
                'Link each item dramatically...',
                'Keep moving through your palace...',
                'Don\'t hesitate - flow continuously...',
                'Final items - make them BIG and EXAGGERATED!'
            ];

            let step = 0;
            const guideInterval = setInterval(() => {
                if (step < guidance.length) {
                    document.getElementById('coachGuidance').textContent = guidance[step];
                    step++;
                }
            }, 6000);

            startTimer('guidedTimer', 30, () => {
                clearInterval(guideInterval);
                document.getElementById('guidedFeedback').classList.remove('hidden');
            });
        }

        function stopGuided() {
            document.getElementById('guidedFeedback').classList.remove('hidden');
        }

        function checkGuidedRecall() {
            const userRecall = document.getElementById('guidedRecall').value
                .split(',')
                .map(i => i.trim())
                .filter(i => i);

            let correct = 0;
            userRecall.forEach((item, idx) => {
                if (item === currentChallenge.items[idx]) correct++;
            });

            const result = document.getElementById('guidedRecallResult');
            result.innerHTML = `
                <div class="feedback ${correct >= 8 ? 'success' : 'error'}">
                    ${correct}/10 correct (${(correct/10*100).toFixed(0)}%)
                </div>
                <p style="margin-top: 15px; color: #e0e0e0;">Expected: ${currentChallenge.items.join(', ')}</p>
            `;
        }

        // SPEED CHALLENGES
        function speedChallenge(seconds) {
            currentChallenge.items = getRandomItems(10);
            currentChallenge.timeLimit = seconds;

            displayItems('speedItems', currentChallenge.items);
            document.getElementById('speedChallengeContainer').classList.remove('hidden');

            startTimer('speedTimer', seconds, () => {
                alert('Time\'s up!');
            });
        }

        function finishSpeedChallenge() {
            const recall = prompt('Type items in order:');
            if (recall) {
                const userItems = recall.split(',').map(i => i.trim());
                const correct = userItems.filter((item, idx) => item === currentChallenge.items[idx]).length;
                alert(`Result: ${correct}/10 correct at ${currentChallenge.timeLimit}s`);
            }
        }

        // CUSTOM CHALLENGE
        function startCustomChallenge() {
            const count = parseInt(document.getElementById('customItemCount').value) || 10;
            const time = parseInt(document.getElementById('customTime').value) || 30;

            currentChallenge.items = getRandomItems(count);
            currentChallenge.timeLimit = time;

            displayItems('customItems', currentChallenge.items);
            document.getElementById('customChallengeContainer').classList.remove('hidden');
            document.getElementById('customRecallContainer').classList.add('hidden');

            startTimer('customTimer', time, () => {
                document.getElementById('customRecallContainer').classList.remove('hidden');
            });
        }

        function finishCustomChallenge() {
            document.getElementById('customRecallContainer').classList.remove('hidden');
        }

        function checkCustomRecall() {
            const userRecall = document.getElementById('customRecall').value
                .split(',')
                .map(i => i.trim())
                .filter(i => i);

            let correct = 0;
            userRecall.forEach((item, idx) => {
                if (item === currentChallenge.items[idx]) correct++;
            });

            const result = document.getElementById('customRecallResult');
            const percentage = (correct / currentChallenge.items.length * 100).toFixed(0);
            result.innerHTML = `
                <div class="feedback ${percentage >= 80 ? 'success' : 'error'}">
                    ${correct}/${currentChallenge.items.length} correct (${percentage}%)
                </div>
            `;
        }

        // FINAL CHALLENGE
        function startFinalChallenge() {
            currentChallenge.items = getRandomItems(10);
            currentChallenge.startTime = Date.now();
            currentChallenge.timeLimit = 30;

            displayItems('finalItems', currentChallenge.items);
            document.getElementById('finalRecallContainer').classList.add('hidden');
            document.getElementById('finalResults').classList.add('hidden');

            startTimer('finalTimer', 30, () => {
                document.getElementById('finalRecallContainer').classList.remove('hidden');
            });
        }

        function submitFinalRecall() {
            const userRecall = document.getElementById('finalRecall').value
                .split(',')
                .map(i => i.trim())
                .filter(i => i);

            let correct = 0;
            const feedback = [];

            userRecall.forEach((item, idx) => {
                if (item === currentChallenge.items[idx]) {
                    correct++;
                } else {
                    feedback.push(`Position ${idx + 1}: Expected "${currentChallenge.items[idx]}", got "${item}"`);
                }
            });

            const accuracy = (correct / 10 * 100).toFixed(0);
            const speed = (30 / 10).toFixed(1);

            document.getElementById('finalCorrect').textContent = `${correct}/10`;
            document.getElementById('finalAccuracy').textContent = `${accuracy}%`;
            document.getElementById('finalSpeed').textContent = `${speed}s`;

            let feedbackHTML = `<p style="color: #d4af37; margin-bottom: 15px;">${accuracy >= 80 ? '‚úì Excellent!' : accuracy >= 60 ? '~ Good effort!' : '‚úó Keep practicing!'}</p>`;
            if (feedback.length > 0) {
                feedbackHTML += '<p><strong>Errors:</strong></p>';
                feedback.forEach(f => {
                    feedbackHTML += `<p style="color: #c86464;">‚Ä¢ ${f}</p>`;
                });
            }

            document.getElementById('finalFeedback').innerHTML = feedbackHTML;
            document.getElementById('finalResults').classList.remove('hidden');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Lesson 21: Speed Memorization loaded');
        });
    </script>
</body>
</html>
